# 前端调试指南

## 🔧 已修复的问题

### 1. API响应拦截器修复 ✅
**问题**: 响应拦截器返回 `res.data` 导致数据访问错误
**解决**: 修改为返回完整的 `res` 对象

### 2. 登录API调用修复 ✅
**问题**: 访问 `res.token` 而不是 `res.data.token`
**解决**: 修改为 `res.data.token`

### 3. 首页API调用修复 ✅
**问题**: 直接访问 `res.slice()` 和 `res.list`
**解决**: 修改为 `res.data.slice()` 和 `res.data.list`

---

## 📝 后端API响应格式

后端统一返回格式：
```json
{
  "code": 200,
  "message": "success",
  "data": {
    // 实际数据
  }
}
```

前端访问方式：
```typescript
const res = await request.get('/api/xxx')
// res.code - 状态码
// res.message - 消息
// res.data - 实际数据
```

---

## 🚀 如何测试前端

### 1. 确保后端服务运行
```bash
# 在后端目录运行
cd d:\AuroraTechMall\backend
mvn spring-boot:run
```

后端应该运行在：http://localhost:8080

### 2. 启动前端服务
```bash
# 在前端目录运行
cd d:\AuroraTechMall\frontend
npm run dev
```

前端应该运行在：http://localhost:3000

### 3. 测试登录功能

#### 用户登录
1. 访问 http://localhost:3000/login
2. 选择"用户"
3. 输入用户名和密码
4. 点击登录

#### 商家登录
1. 访问 http://localhost:3000/login
2. 选择"商家"
3. 输入商家用户名和密码
4. 点击登录

#### 管理员登录
1. 访问 http://localhost:3000/login
2. 选择"管理员"
3. 默认账号：`admin` / `admin123`
4. 点击登录

---

## 🔍 调试技巧

### 1. 查看浏览器控制台
按 `F12` 打开开发者工具，查看：
- **Console**: 查看日志和错误
- **Network**: 查看API请求和响应
- **Application**: 查看LocalStorage中的token

### 2. 检查API请求
在Network标签中：
- 查看请求URL是否正确
- 查看请求头是否包含Token
- 查看响应状态码和数据

### 3. 常见问题排查

#### 问题1: 404 Not Found
**原因**: API路径错误或后端服务未启动
**解决**: 
- 检查后端是否运行在 http://localhost:8080
- 检查API路径是否正确

#### 问题2: 401 Unauthorized
**原因**: Token无效或未登录
**解决**: 
- 重新登录获取新Token
- 检查LocalStorage中是否有token

#### 问题3: CORS跨域错误
**原因**: 跨域配置问题
**解决**: 
- Vite已配置代理，应该不会出现
- 如果出现，检查 `vite.config.ts` 中的proxy配置

#### 问题4: 网络错误
**原因**: 后端服务未启动
**解决**: 
- 启动后端服务
- 检查端口8080是否被占用

---

## 📋 API端点列表

### 认证相关
- `POST /api/auth/customer/register` - 用户注册
- `POST /api/auth/customer/login` - 用户登录
- `POST /api/auth/merchant/register` - 商家注册
- `POST /api/auth/merchant/login` - 商家登录
- `POST /api/auth/admin/login` - 管理员登录

### 商品相关
- `GET /api/product/categories` - 获取分类列表
- `GET /api/product/list` - 获取商品列表
- `GET /api/product/{id}` - 获取商品详情

### 购物车相关
- `GET /api/cart/list` - 获取购物车列表
- `POST /api/cart/add` - 添加到购物车
- `DELETE /api/cart/{id}` - 删除购物车项

### 订单相关
- `GET /api/order/list` - 获取订单列表
- `POST /api/order/create` - 创建订单
- `GET /api/order/{id}` - 获取订单详情

---

## 💡 开发建议

### 1. 使用Vue DevTools
安装Vue DevTools浏览器插件，可以：
- 查看组件树
- 查看组件状态
- 调试Pinia store

### 2. 使用console.log调试
在代码中添加日志：
```typescript
console.log('API响应:', res)
console.log('用户信息:', userInfo)
```

### 3. 使用try-catch捕获错误
```typescript
try {
  const res = await request.get('/api/xxx')
  console.log('成功:', res)
} catch (error) {
  console.error('失败:', error)
}
```

---

## 🎯 下一步开发

### 需要完善的功能

1. **用户端**
   - 商品列表加载真实数据
   - 商品详情加载真实数据
   - 购物车功能对接
   - 订单创建和管理

2. **商家端**
   - 数据统计对接
   - 商品管理CRUD
   - 订单处理功能
   - 评价回复功能

3. **管理端**
   - 数据统计对接
   - 商家审核功能
   - 商品审核功能
   - 用户管理功能

---

## 📞 遇到问题？

1. 检查浏览器控制台的错误信息
2. 检查Network标签中的API请求
3. 确认后端服务正常运行
4. 查看后端日志输出

---

**最后更新**: 2024-12-17
